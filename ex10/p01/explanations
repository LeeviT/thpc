Compile:

$ gfortran -fopenmp p01.f90

Executing command and values that I used:

$ ./a.out 32000 0.01 1000 0.1 100


Version without OpenMP or MPI parallelization:

1.000000000         13.28450116         6.462870077         6.821631079
2.000000000         13.28474839         7.434679336         5.850069049
3.000000000         13.28484583         7.824644881         5.460200949
4.000000000         13.28484135         7.728606686         5.556234666
5.000000000         13.28475835         7.309711417         5.975046934
6.000000000         13.28464176         6.714147178         6.570494584
7.000000000         13.28454106         6.238704639         7.045836426
8.000000000         13.28447928         5.988241408         7.296237872
9.000000000         13.28446326         5.875508803         7.408954452
10.00000000         13.28451210         6.160110538         7.124401562
wall clock time elapsed:   1.78199995

Version with OpenMP parallelization, 4 threads:

1.000000000         13.45351753         6.561330989         6.892186537
2.000000000         13.45377021         7.548266332         5.905503879
3.000000000         13.45386964         7.956368337         5.497501300
4.000000000         13.45385687         7.879745770         5.574111097
5.000000000         13.45376140         7.320482860         6.133278537
6.000000000         13.45365458         6.832062695         6.621591881
7.000000000         13.45355404         6.322549637         7.131004408
8.000000000         13.45349260         6.004299472         7.449193133
9.000000000         13.45349346         6.013066251         7.440427212
10.00000000         13.45354147         6.243246851         7.210294622
wall clock time elapsed:  0.955999970

Version with MPI parallelization, 4 cores:

1.000000000         13.38864854         6.513919185         6.874729354
2.000000000         13.39124030         7.550529879         5.840710426
3.000000000         13.39174240         7.854957147         5.536785249
4.000000000         13.39332282         7.803045614         5.590277208
5.000000000         13.39905161         7.344021149         6.055030463
6.000000000         13.62498147         6.877802191         6.747179275
7.000000000         13.97552892         6.350487703         7.625041219
8.000000000         13.88132541         6.202329719         7.678995690
9.000000000         14.35335364         6.297495553         8.055858082
10.00000000         14.73137535         6.896820505         7.834554845
wall clock time elapsed:   0.71799999999999997
